name: Update Google OAuth Client

on:
    deployment_status:

jobs:
    update-google-oauth-client:
        if: github.event_name == 'deployment_status' && github.event.deployment_status.state == 'success'
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Code
              uses: actions/checkout@v2

            - name: Set up Python
              uses: actions/setup-python@v2
              with:
                  python-version: 3.x

            - name: Install Dependencies
              run: pip install --upgrade google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client

            - name: Update Google OAuth Client
              run: |
                  python scripts/update_google_oauth_client.py
              env:
                  SERVICE_ACCOUNT_CREDS: ${{ secrets.SERVICE_ACCOUNT_CREDS }}
